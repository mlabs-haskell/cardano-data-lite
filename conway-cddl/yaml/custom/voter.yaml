# ; Constitutional Committee Hot KeyHash: 0
# ; Constitutional Committee Hot ScriptHash: 1
# ; DRep KeyHash: 2
# ; DRep ScriptHash: 3
# ; StakingPool KeyHash: 4
# voter =
#   [ 0, addr_keyhash
#   // 1, scripthash
#   // 2, addr_keyhash
#   // 3, scripthash
#   // 4, addr_keyhash
#
#   ]
#
VoterEnum:
  type: enum
  values:
    - name: ConstitutionalCommitteeHotKeyHash
      value: 0

    - name: ConstitutionalCommitteeHotScriptHash
      value: 1

    - name: DRepKeyHash
      value: 2

    - name: DRepScriptHash
      value: 3

    - name: StakingPoolKeyHash
      value: 4

Voter: # TODO (custom serializer)
  type: record
  methods:
    new: null
    kind: null
  fields:
    - name: constitutional_committee_hot_credential
      type: Credential
      nullable: true
    - name: drep_credential
      type: Credential
      nullable: true
    - name: staking_pool_key_hash
      type: Ed25519KeyHash
      nullable: true

  extra_methods: |
    static new_constitutional_committee_hot_credential(cred: Credential): Voter {
      return new Voter(cred, undefined, undefined);
    }
    static new_drep_credential(cred: Credential): Voter {

      return new Voter(undefined, cred, undefined);
    }
    static new_stake_pool_key_hash(key_hash: Ed25519KeyHash): Voter {
      return new Voter(undefined, undefined, key_hash);
    }
    kind(): VoterEnumKind {
      if (this._constitutional_committee_hot_credential) {
        switch (this._constitutional_committee_hot_credential.kind()) {
          case (CredentialKind.Ed25519KeyHash):
            return VoterEnumKind.ConstitutionalCommitteeHotKeyHash;
          case (CredentialKind.ScriptHash):
            return VoterEnumKind.ConstitutionalCommitteeHotScriptHash;
        }
      }

      if (this._drep_credential) {
        switch (this._drep_credential.kind()) {
          case (CredentialKind.Ed25519KeyHash):
            return VoterEnumKind.DRepKeyHash;
          case (CredentialKind.ScriptHash):
            return VoterEnumKind.DRepScriptHash;
        }
      }

      return VoterEnumKind.StakingPoolKeyHash;
    }

    to_constitutional_committee_hot_credential(): Credential | undefined {
      return this._constitutional_committee_hot_credential;
    }
    to_drep_credential(): Credential | undefined {
      return this._drep_credential;
    }
    to_stake_pool_key_hash(): Ed25519KeyHash | undefined {
      return this._staking_pool_key_hash;
    }

    has_script_credentials(): boolean {
      if (this._constitutional_committee_hot_credential) {
         // TODO: uncomment when implemented
         // return this._constitutional_committee_hot_credential.has_script_hash();
       }

       if (this._drep_credential) {
         // TODO: uncomment when implemented
         // return this._drep_credential.has_script_hash();
       }

       return false;
    }
    to_key_hash(): Ed25519KeyHash | undefined {
      if (this._staking_pool_key_hash) {
        return this._staking_pool_key_hash;
      }
      return undefined;
    }

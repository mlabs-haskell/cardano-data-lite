ConstrPlutusData:
  type: record
  fields:
    - name: alternative
      type: BigNum
    - name: data
      type: PlutusList
  methods:
    deserialize: deserializeWithSeparateIdx
    serialize: serializeWithSeparateIdx
    new: uncheckedNew
  extra_methods: |
    static deserialize(reader: CBORReader, path: string[]): ConstrPlutusData {      
      const tag = reader.readTaggedTagAsBigInt(path);
      if (Number(tag) >= 121 && Number(tag) <= 127) {
        return ConstrPlutusData.new(
          BigNum.new(tag).checked_sub(BigNum.from_str("121")),
          PlutusList.deserialize(reader, [...path, "PlutusList(data)"]),
        );
      } else if (Number(tag) == 102) {
        return ConstrPlutusData.deserializeWithSeparateIdx(reader, path);
      } else {
        throw new Error(
          "Unexpected tagfor ConstrPlutusData: " +
            tag +
            "(at " +
            path.join("/") +
            ")",
        );
      }
    }

    serialize(writer: CBORWriter): void {
      const alternative = this.alternative().toJsValue();
      if (alternative > 6) {
        writer.writeTaggedTag(102);
        this.serializeWithSeparateIdx(writer);
      } else {
        writer.writeTaggedTag(Number(alternative) + 121);
        this.data().serialize(writer);
      }
    }

    static new(alternative: BigNum, data: PlutusList): ConstrPlutusData {
      return ConstrPlutusData.uncheckedNew(alternative, data)
    }
    
